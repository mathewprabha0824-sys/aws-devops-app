---
- name: Bootstrap servers with Python 3.9
  hosts: all
  become: yes
  gather_facts: no

  tasks:
    - name: Enable python3.9 in amazon-linux-extras
      command: amazon-linux-extras enable python3.9
      args:
        creates: /usr/bin/python3.9

    - name: Install Python 3.9
      yum:
        name: python3.9
        state: present

    - name: Set python3.9 as default
      alternatives:
        name: python3
        path: /usr/bin/python3.9
        link: /usr/bin/python3

    - name: Verify Python version
      command: python3 --version
      register: python_version

    - name: Show Python version
      debug:
        msg: "Python version installed: {{ python_version.stdout }}"
